<!doctype html>
<html>
  <head>
    <meta charset="utf-8">
    <title>bzzzt</title>
  </head>
  <body>
    <button id="button" active>Unlock</button>
    <script>
    (function() {
      function post() {
        var xhr = new XMLHttpRequest();
        xhr.open("POST", document.location.pathname, true);
        xhr.setRequestHeader("content-type",
                             "application/x-www-form-urlencoded");
        xhr.send.apply(xhr, arguments);
        return xhr;
      }

      var button = document.getElementById("button");

      button.addEventListener("mousedown", function(e) {
        if (e.button !== 0) {
          return;
        }

        var token = Date.now();

        function onMouseUp() {
          post("token=" + token + "&is_pressed=no");
          button.removeEventListener("mouseup", onMouseUp);
        }

        post("token=" + token + "&is_pressed=yes");
        button.addEventListener("mouseup", onMouseUp, false);
      }, false);
    })();
    </script>
  </body>
</html>
