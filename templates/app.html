<!doctype html>
<html>
  <head>
    <meta charset="utf-8">
    <title>bzzzt</title>
  </head>
  <body>
    <button id="finger">Open door</button>
    <script>
    (function() {
      function post() {
        var xhr = new XMLHttpRequest();
        xhr.open("POST", document.location.pathname, true);
        xhr.setRequestHeader("content-type",
                             "application/x-www-form-urlencoded");
        xhr.send.apply(xhr, arguments);
        return xhr;
      }

      finger.addEventListener("mousedown", function() {
        var token = Date.now();

        function onMouseUp() {
          post("token=" + token + "&is_pressed=no");
          finger.removeEventListener("mouseup", onMouseUp);
        }

        post("token=" + token + "&is_pressed=yes");
        finger.addEventListener("mouseup", onMouseUp, false);
      }, false);
    })();
    </script>
  </body>
</html>
